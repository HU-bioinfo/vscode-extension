# work-env

`work-env` は、統一された R および Python 開発環境を提供する解析用の VSCode 拡張機能です。コマンドを実行するだけで、簡単に解析環境をセットアップし、使用することができます。

## Features

- **統一された開発環境**: R と Python の統一環境を提供
- **簡単なセットアップ**: 少ない手順で環境構築が可能
- **効率的なリソース管理**: テンプレートベースの構成で柔軟な環境設定が可能
- **強化されたエラー処理**: 詳細なエラーメッセージと自動復旧機能

## Requirements

- **サポートされている OS**: Linux, macOS
- **Windows 対応**: WSL（Windows Subsystem for Linux）経由で使用可能

## Usage

- **Start work-env**: 開発環境を起動します。※初期セットアップが完了していない場合、自動で開始します。
- **Reset work-env config**: 設定をリセットして再度設定を行いたい場合に実行します。

- 設定項目：それぞれ設定ダイアログが表示されます。
  1. **プロジェクトフォルダ**: プロジェクトが格納されているフォルダのパスを指定します。
  2. **キャッシュディレクトリ**: 解析時に利用するキャッシュやライブラリを格納するフォルダのパスを指定します。
  3. **GitHub Personal Access Token (PAT)**: GitHub へのアクセスに必要なトークンです。GitHub アクセス時に使用します。

## ディレクトリ構造

```
work-env/
├── src/                  # 拡張機能のソースコード
│   ├── extension.ts      # メインの拡張機能コード
│   └── test-helper.ts    # テスト用ヘルパー関数
├── resources/            # 静的リソース
│   ├── templates/        # テンプレートファイル
│   │   ├── devcontainer_template/  # .devcontainerディレクトリのテンプレート
│   │   │   ├── devcontainer.json.template  # devcontainer設定テンプレート
│   │   │   └── docker-compose.yml.template # Docker Compose設定テンプレート
├── test/                 # テストコード
└── package.json          # エクステンション設定
```

## License

MIT License

## テスト

このエクステンションには、エラーハンドリングを含む包括的なユニットテストが含まれています。以下のコマンドでテストを実行できます：

```bash
# ユニットテストの実行
npm run unit-test

# テストカバレッジの計測
npm run test:coverage
```

### テストの種類

1. **基本的なテスト** - 単純な機能のテスト
2. **エラーハンドリングテスト** - 様々なエラー状況に対する処理のテスト
   - Docker 関連のエラー処理
   - Docker Compose 関連のエラー処理
   - ファイルシステム関連のエラー処理
   - ネットワーク関連のエラー処理
3. **VSCode API 統合テスト** - コマンド登録や拡張機能の活性化のテスト
4. **リソース処理テスト** - テンプレートからのファイル生成と設定処理のテスト

### 最新テスト結果

**テスト実行結果（2024-04-05）**

- テスト件数: 102 件
- 成功率: 100%
- カバレッジ: ステートメント 55.44%、ブランチ 41.47%、関数 57.79%

詳細なテスト情報は以下のドキュメントで確認できます：

- [テスト結果](docs/test-results.md) - テスト実行結果とカバレッジレポート
- [仕様書](docs/specification.md) - エクステンションの詳細仕様と実装内容

## 最近の改善点（2024-04-05）

1. **リソース管理の改善**: テンプレートファイルを`resources/templates`ディレクトリに移動し、より明確な構造化
2. **VSCode API 利用の最適化**: `vscode.Uri.joinPath`を使用した安全なリソースアクセス
3. **エラー処理の強化**: 詳細なエラーメッセージとファイル操作の堅牢性向上
4. **テストの拡充**: 新しいリソース管理方法に対応したテストケースの追加

## 機能
