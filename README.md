# work-env

`work-env` は、統一された R および Python 開発環境を提供する解析用の VSCode 拡張機能です。コマンドを実行するだけで、簡単に解析環境をセットアップし、使用することができます。

## 機能

- **統一された開発環境**: R と Python の統一環境を Docker コンテナで提供
- **簡単なセットアップ**: VSCode の UI を通じて簡単に環境構築が可能
- **プロジェクト分離**: プロジェクトごとに独立した環境設定が可能
- **キャッシュ共有**: ライブラリやパッケージなどをキャッシュとして共有可能
- **Docker インストール支援**: Docker がインストールされていない場合、自動インストールを提案

## 必要条件

- VS Code 1.60.0以上
- Dockerがインストールされていること
- インターネット接続があること

## システム要件

- **サポートされているOS**: Linux, macOS, Windows (WSL2経由)
- **事前要件**:
  - Docker がインストールされていること

## 使い方

1. **コマンドパレットから `work-env: Start work-env` を実行**
   - 初回実行時は設定ウィザードが表示されます
   - Docker の自動チェックと必要に応じたインストール支援

2. **設定項目の入力**:
   - **作業環境ディレクトリ**: 作業環境を構築する親ディレクトリを選択
   - **GitHub Personal Access Token (PAT)**: GitHub リポジトリへのアクセスに必要なトークン

3. **環境構築完了後**:
   - コンテナ内でフォルダが開き、すぐに作業を開始できます
   - プロジェクトディレクトリには基本的なR/Pythonプロジェクト構造が用意されています

4. **設定のリセット**: 必要に応じて `work-env: Reset work-env Config` を実行

## ディレクトリ構造

作業環境ディレクトリには以下の構造が作成されます:

```
作業環境ディレクトリ/
├── cache/                # キャッシュディレクトリ（コンテナからマウント）
└── container/            # コンテナ設定とプロジェクトファイル
    ├── .devcontainer/    # VSCode Remote Container設定
    └── projects/         # プロジェクトディレクトリ
```

## 詳細情報

- [仕様書](docs/specification.md) - 詳細な仕様と実装内容
- [テスト戦略](docs/testing.md) - テスト方法と結果
- [テスト結果履歴](docs/test_results/README.md) - バージョン別のテスト結果

## License

MIT License

## テスト

このエクステンションには、エラーハンドリングを含む包括的なユニットテストが含まれています。以下のコマンドでテストを実行できます：

```bash
# ユニットテストの実行
npm run unit-test

# テストカバレッジの計測
npm run test:coverage
```

### テストの種類

1. **基本的なテスト** - 単純な機能のテスト
   - Docker インストール確認のテスト
   - Docker イメージプルのテスト
   - コンテナ起動のテスト
2. **エラーハンドリングテスト** - 様々なエラー状況に対する処理のテスト
   - Docker 関連のエラー処理
   - Docker Compose 関連のエラー処理
   - ファイルシステム関連のエラー処理
   - ネットワーク関連のエラー処理
3. **VSCode API 統合テスト** - コマンド登録や拡張機能の活性化のテスト
4. **リソース処理テスト** - テンプレートからのファイル生成と設定処理のテスト

### 最新テスト結果

**テスト実行結果（2024-04-05）**

- テスト件数: 102 件
- 成功率: 100%
- カバレッジ: ステートメント 55.44%、ブランチ 41.47%、関数 57.79%

詳細なテスト情報は以下のドキュメントで確認できます：

- [テスト結果履歴](docs/test_results/README.md) - バージョン別のテスト実行結果とカバレッジレポート
- [テスト戦略](docs/testing.md) - テスト方法と実行方法
- [仕様書](docs/specification.md) - エクステンションの詳細仕様と実装内容

## バージョンアップ手順

新しいバージョンをリリースする前に、以下の手順でテストを実行し、結果を保存します：

```bash
# テスト結果を保存（自動的に全テストを実行）
npm run test:save-results

# バージョンアップ（テスト結果保存も自動実行）
npm version patch  # パッチバージョンアップの場合
npm version minor  # マイナーバージョンアップの場合
npm version major  # メジャーバージョンアップの場合
```

## 最近の改善点（2024-04-05）

1. **リソース管理の改善**: テンプレートファイルを`resources/templates`ディレクトリに移動し、より明確な構造化
2. **VSCode API 利用の最適化**: `vscode.Uri.joinPath`を使用した安全なリソースアクセス
3. **エラー処理の強化**: 詳細なエラーメッセージとファイル操作の堅牢性向上
4. **テストの拡充**: 新しいリソース管理方法に対応したテストケースの追加

## 機能
