# bioinfo-launcher 拡張機能仕様書 - コマンド仕様

## 主要コマンド

拡張機能は以下の 3 つのコマンドを提供します：

### 1. bioinfo-launcher.start-launcher

開発環境を起動するコマンド

**初回実行時**:
- 設定ウィザードを表示
- 親ディレクトリをユーザーが選択
- Docker の存在をチェック
- Docker がインストールされていない場合、自動インストールを提案
- 必要な Docker イメージをプル
- リソースフォルダからテンプレートを取得し、環境設定に基づいて Docker Compose/.devcontainer ファイルを生成
- devcontainerの「Open Folder in Container」で親ディレクトリに展開されたcontainerディレクトリをdevcontainerとして開く
- projectsディレクトリにサンプルプロジェクトを展開

**二回目以降の実行時**:
- 保存された親ディレクトリの設定が有効な場合、セットアップをスキップ
- Docker イメージの更新チェックを実行
- 更新がある場合はリビルドを提案
- .devcontainer設定を最新テンプレートで更新（エクステンション更新対応）
- 既存のコンテナディレクトリを直接開く
- projectsディレクトリのユーザーデータは保持

### 2. bioinfo-launcher.reset-config

設定をリセットするコマンド
- 既存のコンテナを削除
- 設定ウィザードを再度表示
- 新しい設定で環境を再構築
- .devcontainer設定を最新テンプレートで更新

### 3. bioinfo-launcher.config-container

コンテナイメージを設定するコマンド
- 利用可能なDockerイメージから選択
- 既存の設定を更新
- docker-compose.ymlを自動更新
- 既存コンテナの再作成を提案

## 設定プロセス

1. **作業環境ディレクトリの選択**: ユーザーは1つの親ディレクトリを選択します。この選択したディレクトリ内に`cache`ディレクトリと`container`ディレクトリが作成されます
2. **GitHub Personal Access Token (PAT) の入力**: GitHub リポジトリにアクセスするための認証トークンを入力
3. **テンプレートの処理**: リソースフォルダからテンプレートを取得し、`_template`や`.template`拡張子を取り除いた状態で、選択した親ディレクトリに配置します

## 事前チェックフロー（preparation関数）

`start-launcher`、`reset-config`、`config-container` の各コマンド実行時に共通して実行される事前チェック：

1. **Docker インストール確認**:
   - システムに Docker がインストールされているかを確認
   - インストールされていない場合は自動インストールを提案

2. **Docker 権限確認**:
   - ユーザーが Docker コマンドを実行する権限があるかを確認
   - 権限がない場合は適切な対処方法を提案

3. **Docker イメージ更新確認**:
   - 設定されたイメージ（デフォルト: `hubioinfows/lite_env:latest`）の更新をチェック
   - ローカルイメージとリモートイメージのハッシュを比較
   - 更新がある場合はユーザーに通知し、既存環境がある場合はリビルドを提案